USE [GYMASTER]
GO
/****** Object:  StoredProcedure [dbo].[SP_GET_TOTALSALES_BY_SUBSCRIPTION]    Script Date: 12/14/2024 10:47:57 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROCEDURE [dbo].[SP_GET_TOTALSALES_BY_SUBSCRIPTION]
	@YEAR INT
	, @MTH INT
AS
BEGIN
	SELECT 
		YEAR(TRANSAC_DATE) AS YR
		, MONTH(TRANSAC_DATE) AS MTH
		, DATENAME(MONTH,TRANSAC_DATE) AS MTH_DESCRIPTION
		, DURATION
		, A.SUB_NAME
		, SUM(PRICE) AS TOTALSALES
	 FROM SUBSCRIPTION  A
	INNER JOIN [TRANSACTION] B ON A.SUB_ID = B.SUB_ID
	WHERE YEAR(TRANSAC_DATE) = @YEAR AND MONTH(TRANSAC_DATE) = @MTH
	GROUP BY YEAR(TRANSAC_DATE), A.SUB_NAME, MONTH(TRANSAC_DATE), DATENAME(MONTH,TRANSAC_DATE), DURATION
END
